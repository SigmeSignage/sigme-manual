<!--toc=widgets-->

# 株式

株式ウィジェットでは、掲載されている銘柄の取引価格情報を表示します。

## インストール

株式ウィジェットは、株式市場のデータを取得するために[Alpha Vantage Stock API](https://www.alphavantage.co/)を利用しています。Alpha Vantageが返す株価は、以下の標準に従っています。
[株式市場の標準](https://medium.com/@patrick.collins_58673/stock-api-landscape-5c6e054ee631)に従って、分割や配当金支払いなどの企業イベントを反映した価格を返します。

インストールする前に、APIキーが必要です。[Alpha Vantage](https://www.alphavantage.co/support/#api-key)でアカウントを作成し、キーを取得してください。

株式モジュールは、メニューの管理セクションにあるモジュールページよりインストールします。**モジュールをインストール**ボタンをクリックし、インストールするモジュールを選択します。

インストール後、グリッドからモジュールを選択し、行メニューから**編集**を行います。

フォームのフィールドに入力し、**APIキー**とキャッシュ期間の設定を入力します。

## ウィジェットを追加

[ウィジェット](layouts_widgets.html)ツールバーの**株式**をクリックし、追加またはドラッグ＆ドロップしてください。

追加すると、設定オプションがプロパティパネルに表示されます。

- 識別しやすいように **名前** を記入してください。
- 必要であれば、デフォルトの**期間**を上書きすることを選択します。
- 項目ごとの継続時間かどうかを選択し、チェックを外すとページ/項目数ごとの継続時間となります。

### 設定

![Stocks Configuration](img\v3.1_media_stocks_configuration.png)

- 結果を返すために、カンマで区切られた株式シンボル（ティッカー）のリストを入力してください。

{tip}
もし、特定の取引所でのみ取引されている銘柄記号が必要な場合は、`SYMBOL:EXCHANGE`というフォーマットを使って結果を返すことができます。
{/tip}

{tip}
株式記号は、[Yahooファイナンス](https://finance.yahoo.com/)などの各種検索サイトで確認することができます!
{/tip}

### 外観

- オプションで、カラーピッカーを使用して**背景色**を選択します。
- 返された結果に適用する PHP の **日付形式** を指定します(日付形式については、ページの下部を参照してください)。
- 項目間の遷移に使用する**エフェクト**と**速度**をオプションで選択します

{tip}
このウィジェットの**水平方向**と**垂直方向**のアライメントオプションを設定します。
{/tip}

### テンプレート

利用可能なテンプレートから選択します。

- **プリセット** - ドロップダウンでプリセットテンプレートの1つを選択します。

![Preset Stocks Templates](img\v3.1_media_stocks_preset_templates.png)

{tip}

必要であれば、選択したテンプレートを上書きするをクリックします。
詳しくは、後述の「プリセットテンプレートの編集」の項をご覧ください。
{/tip}

- **レコードなしメッセージ** 返されたレコードがないときに表示するメッセージを指定します。

### プリセットテンプレートを編集

テンプレートは、ドロップダウンでテンプレートを選択し、**テンプレートを上書き**のチェックボックスをクリックすることで編集することができます。

{tip}
テンプレートは自動的に拡大縮小されるため、意図した出力解像度に合わせた設計が必要です。テンプレートを編集する際には、以下のガイドラインを考慮する必要があります。

- テンプレートは固定サイズで設計する必要があります
- フォント、マージン、幅、高さなど、すべての要素で絶対サイズ（px）を使用する必要があります。
- 位置指定がある場合は、top,left で指定する必要があります。
- テンプレートはブートストラップを使用することができます
- 縦横比は[[PRODUCTNAME]]で固定され、リージョンに合わせたサイズになります。
- テンプレートは静止画像と同じように扱われます。
{/tip}

上書きを選択した後、**テンプレートタブ**をクリックして編集するテンプレートを選択します。

![Currencies Override the Template](img\v3.1_media_stocks_override_templates.png)!!

**メインテンプレート** - ビジュアルエディタをオンにすると、インラインエディタにアクセスしてテキストや書式を入力したり、提供されたボックスにテキスト/HTMLを入力したりすることができます。

**項目テンプレート**  - 各項目に適用するテンプレートを入力します。ビジュアルエディタを使用するか、テキスト/HTMLをボックス内に入力します。

**オプションのスタイルシート** - 上記のテンプレートに適用するCSSです。

{tip}
このオプションのテンプレートは、CMSが生成する出力を「調整」する上級ユーザー向けのものです!
{/tip}

### キャッシュ

更新間隔は、できるだけ長く、適切な時間を分単位で設定します。

### 結果

いつでも結果を取得し、どのようなデータが返されるかを確認することができます。どのフィールドも、角括弧 [] の間にフィールド名を入力するだけで、テンプレートで使用する代用品として利用できます。

### アクション

このウィジェットにはアクションを付けることができます。詳しくは、[対話型アクション](layouts_interactive_actions.html)のページを参照してください。

## 補足情報

[[PRODUCTNAME]]は、正しいPHPの日付形式であるすべての日付形式が利用できます。次の文字が認識され、使用できます：

| 文字 | 説明                                                  | 返される文字の例                 |
| ---------------- | :----------------------------------------------------------- | --------------------------------------- |
|                  | **日**                                                      |                                         |
| d                | ゼロから始まる２桁の日付              | 01 から 31                                |
| D                | 日を表すテキスト, ３文字            | Mon から Sun                         |
| j                | ゼロをつけない日付                       | 1 から 31                                 |
| l                | (小文字‘L’) 日を表す完全な文字列 | Sunday から Saturday                 |
| N                | ISO-8601で定義された曜日を表す数字(PHP 5.1.0で追加された) | 1 (月曜日) から 7 (日曜日)   |
| S                | 日にちに対する英語の序数サフィックス、2文字| st, nd, rd または th. とともに使われる     |
| w                | 曜日の数字表現         | 0 (Sunday) から 6 (Saturday) |
| z                | 年初からの日（0から始まる)                        | 0 から 365                           |
|                  | **週**                                                     |                                         |
| W                | ISO-8601で規定する週の数字, 週は月曜日から始まる(PHP 4.1.0で追加) | 42 (一年の中の42週目)          |
|                  | **月**                                                    |                                         |
| F                | 月のテキスト表現, January や March | January から December                |
| m                | ゼロで始まる月の数字表現        | 01 から 12                           |
| M                | 月の短いテキスト表現、３文字     | Jan から Dec                         |
| n                | 月の数字表現、先頭にゼロはつかない| 1 から 12                            |
| t                | 月の日数                            | 28 から 31                           |
|                  | **年**                                                     |                                         |
| L                | うるう年かどうか                                      | 1 うるう年, 0 それ以外.    |
| o                | ISO-8601できていされた年. これはYと同じ値です。ただし、ISOの週番号（W）が前後の年に属している場合は、その年が代わりに使用されます。(PHP 5.1.0で追加) | 1999 または 2003                            |
| Y                | 年の４桁数字表現            | 1999 または 2003                            |
| y                | 年の２桁数字表現                         | 99 or 0                                 |

